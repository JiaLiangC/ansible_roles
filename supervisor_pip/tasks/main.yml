# edirtor: haifeng
# 2017/01/12


- include: supervisor_{{supervisor_install_method}}_install.yml
  tags:
    - install_supervisor
#  when: supervisor_install_method == "local"

#- include: supervisor_net_install.yml
#  when: supervisor_install_method == "net"

- include: create_supervisor_dir.yml
  tags:
    - create_supervisor_dir

- include: copy_supervisor_conf.yml
  tags:
    - copy_supervisor_conf

- include: cent6_service.yml
  #when: ansible_os_family == "RedHat" and ansible_lsb.major_release|int == 6
  # ansible-2.3.0.0
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version|int == 6

- include: cent7_service.yml
  #when: ansible_os_family == "RedHat" and ansible_lsb.major_release|int == 7
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version|int == 7

- name: set supervisord boot and starting up
  service: name={{ item.name }} state={{ item.state }} enabled=yes
  with_items:
    - { name: "{{supervisor_prog_name}}", state: started }

