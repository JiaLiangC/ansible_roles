# edirtor: haifeng
# 2017/01/12

- name: create k8s user
  user: 
    name: '{{k8s_run_user}}' 
    state: present

- name: create k8s dir
  file: 
    path: '{{ item.path }}' 
    owner: '{{ item.owner }}' 
    group: '{{ item.group }}' 
    mode: '{{ item.mode }}' 
    state: '{{ item.state }}'
  loop:
    - { path: "{{app_base_dir}}", owner: root, group: root, mode: "0755", state: directory }
    - { path: "{{k8s_install_dir}}", owner: root, group: root, mode: "0755", state: directory }
    - { path: "/data/apps/log/kube-audit", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }
    - { path: "/data/apps/log/kube-apiserver", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }
    - { path: "/data/apps/log/kube-controller-manager", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }
    - { path: "/data/apps/log/kube-scheduler", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }
    - { path: "{{k8s_conf_dir}}/ssl", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }
    - { path: "/usr/libexec/kubernetes", owner: '{{k8s_run_user}}', group: '{{k8s_run_user}}', mode: "0755", state: directory }

