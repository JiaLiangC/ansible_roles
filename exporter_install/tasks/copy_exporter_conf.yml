
- name: copy exporter conf file
  template: 
    src: "{{item}}" 
    dest: "{{exporter_conf_dir}}" 
    owner: "{{exporter_run_user}}" 
    group: "{{exporter_run_group}}" 
    mode: "0644"
  with_items: '{{exporter_conf_file}}'
  when: item is not none
  #register: copy_conf_file

- name: copy exporter boot file
  template: 
    src: "{{exporter_boot_file}}" 
    dest: "{{supervisor_conf_dir}}" 
    owner: "{{exporter_run_user}}" 
    group: "{{exporter_run_group}}" 
    mode: "0644"

- name: restart exporter prog
  supervisorctl: 
    config: "{{supervisor_prim_conf}}" 
    name: "{{exporter_base_name}}" 
    state: restarted 
    supervisorctl_path: "/usr/bin/supervisorctl"
