
- include_tasks: project_packet_build_docker_image.yml
  name: project_packet_build_docker_image
  when: project_docker_file is not none and project_docker_file != ""
  tags:
    - project_packet_build_docker_image

- name: copy project k8s resource file
  template: 
    src: "{{item}}" 
    dest: "{{project_install_dir}}" 
    owner: "{{project_run_user}}" 
    group: "{{project_run_group}}" 
    mode: "0644"
    backup: yes
  loop: '{{project_k8s_res_files}}'
  when: item is not none
  register: copy_k8s_res_file

- name: submit res file to k8s cluster
  k8s:
    kubeconfig: '{{project_k8s_kubeconfig}}'
    src: '{{project_install_dir}}/{{item | basename}}'
  loop: '{{project_k8s_res_files}}'
  when: item is not none
