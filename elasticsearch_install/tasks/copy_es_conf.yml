- name: copy es env file
  template: src={{ item.src }} dest={{ item.dest }} owner={{ item.owner }} group={{ item.group }} mode={{ item.mode }} backup=yes
  with_items:
    - { src: 'es.sh', dest: '/etc/profile.d/', owner: root, group: root, mode: "0644" }
    - { src: 'elasticsearch.ini', dest: '{{supervisor_conf_dir}}', owner: root, group: root, mode: "0644" }
    #- { src: 'htpasswd', dest: '{{ config_dir }}/nginx/' , owner: 'root', group: 'root', mode: '0644'}

- name: copy es conf file
  template: src={{ item }} dest={{ es_base_dir }}/config owner={{ es_run_user }} group={{ es_run_user }} mode=0644 backup=yes
  with_items: '{{es_confs}}'
  tags:
   - modify_es_conf
#  notify:
#   - restart nginx service
